# 人员批量导入功能使用说明

## 功能概述

人员批量导入功能允许您通过 Excel 文件批量导入人员信息，支持多种导入模式和完整的数据验证。

## 导入模式

### 1. 追加模式（append）
- 默认模式
- 只添加新的人员记录
- 如果人员编码已存在，根据"跳过重复数据"设置决定是否跳过

### 2. 更新模式（update）
- 更新已存在的人员记录
- 根据人员编码匹配现有记录并更新
- 如果人员编码不存在，则创建新记录

### 3. 跳过模式（skip）
- 只导入新的人员记录
- 如果人员编码已存在，自动跳过该记录

## Excel 模板

### 必填字段
- **name**: 姓名（不能为空）
- **code**: 人员编码（不能为空，必须唯一）

### 可选字段
- **organization_id**: 所属组织ID（必须是有效的组织ID）
- **position**: 职位
- **job_level**: 职级
- **gender**: 性别（male/female/other）
- **birth_date**: 出生日期（格式：YYYY-MM-DD 或 YYYY/MM/DD）
- **id_card**: 身份证号（15位或18位）
- **phone**: 手机号码（11位数字）
- **email**: 邮箱（必须包含@符号）
- **address**: 住址
- **emergency_contact**: 紧急联系人
- **emergency_phone**: 紧急联系电话
- **hire_date**: 入职日期（格式：YYYY-MM-DD 或 YYYY/MM/DD）
- **probation_end_date**: 试用期结束日期（格式：YYYY-MM-DD 或 YYYY/MM/DD）
- **contract_start_date**: 合同开始日期（格式：YYYY-MM-DD 或 YYYY/MM/DD）
- **contract_end_date**: 合同结束日期（格式：YYYY-MM-DD 或 YYYY/MM/DD）
- **employment_status**: 在职状态（active/probation/leave/retired/resigned）
- **work_location**: 工作地点
- **education**: 学历
- **major**: 专业
- **school**: 毕业院校
- **skills**: 技能
- **experience**: 工作经历

## 使用步骤

### 1. 准备 Excel 文件
1. 下载或生成导入模板
2. 按照模板格式填写人员信息
3. 确保必填字段都已填写
4. 检查数据格式是否正确

### 2. 执行导入
1. 登录系统（需要管理员权限）
2. 进入"人员管理"页面
3. 点击"批量导入"按钮
4. 选择准备好的 Excel 文件
5. 选择导入模式
6. 设置是否跳过重复数据
7. 点击"提交"

### 3. 查看导入结果
导入完成后，系统会显示：
- 总记录数
- 成功导入数
- 失败数
- 跳过数
- 成功率
- 错误详情（前10条）

## 数据验证规则

### 人员编码（code）
- 不能为空
- 必须唯一
- 不能重复

### 姓名（name）
- 不能为空

### 手机号码（phone）
- 必须是11位数字
- 如果填写，必须符合格式

### 邮箱（email）
- 必须包含@符号
- 如果填写，必须符合格式

### 身份证号（id_card）
- 必须是15位或18位
- 如果填写，必须符合格式

### 日期字段
- 格式必须是 YYYY-MM-DD 或 YYYY/MM/DD
- 如果填写，必须符合格式

### 性别（gender）
- 必须是：male、female 或 other
- 如果填写，必须符合格式

### 在职状态（employment_status）
- 必须是：active、probation、leave、retired 或 resigned
- 如果填写，必须符合格式

### 组织ID（organization_id）
- 必须是系统中存在的组织ID
- 如果填写，必须有效

## 常见问题

### Q: 导入失败，提示"人员编码已存在"
A: 请检查Excel文件中是否有重复的人员编码，或者该编码已在系统中存在。可以尝试使用"更新模式"或"跳过模式"。

### Q: 导入失败，提示"手机号码必须是11位数字"
A: 请检查手机号码格式，确保是11位纯数字，不要包含空格、横线或其他字符。

### Q: 导入失败，提示"日期格式不正确"
A: 请检查日期格式，确保使用 YYYY-MM-DD 或 YYYY/MM/DD 格式，例如：2024-01-15 或 2024/01/15。

### Q: 导入失败，提示"组织ID不存在"
A: 请检查组织ID是否正确，确保该组织已在系统中创建。可以先在"组织管理"中查看组织ID。

### Q: 部分记录导入成功，部分失败
A: 系统会继续处理其他记录，导入完成后会显示详细的错误信息。请根据错误信息修正数据后重新导入失败的记录。

## 注意事项

1. **权限要求**: 只有管理员权限的用户才能执行批量导入操作
2. **文件格式**: 只支持 .xlsx 和 .xls 格式的Excel文件
3. **数据量**: 建议单次导入不超过1000条记录
4. **备份**: 建议在导入前备份数据库
5. **测试**: 建议先用少量数据测试导入功能
6. **编码唯一性**: 人员编码在系统中必须唯一
7. **组织有效性**: 组织ID必须在系统中存在
8. **日期格式**: 严格按照指定格式填写日期
9. **联系方式**: 手机号和邮箱格式必须正确
10. **错误处理**: 导入失败的数据不会影响已成功导入的数据

## 技术支持

如遇到问题，请联系系统管理员或技术支持团队。
